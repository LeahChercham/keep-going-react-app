{"ast":null,"code":"import _slicedToArray from\"C:/Users/LeahC/OneDrive/Documents/AKAD/ABSCHLUSS BAK PROJ BACH/PROJEKT/ProjectCode/keep-going-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useRef,useContext}from'react';import{useLocation}from'react-router-dom';import{Button}from'@mui/material';import styles from'@chatscope/chat-ui-kit-styles/dist/default/styles.min.css';import{MainContainer,ChatContainer,MessageList,Message,MessageInput,Sidebar,Search,ConversationList,Conversation,ExpansionPanel,ConversationHeader,VoiceCallButton,VideoCallButton,InfoButton,TypingIndicator,MessageSeparator}from'@chatscope/chat-ui-kit-react';import{useDispatch,useSelector}from'react-redux';import toast,{Toaster}from'react-hot-toast';import{getContacts,messageSend,getMessage,ImageMessageSend,seenMessage,updateMessage}from'../../store/actions/messengerAction';import{getOfferContacts,getOffer,offerSend,updateOffer}from'../../store/actions/offerAction';import{userGet}from'../../store/actions/authActions';import{SocketContext}from'../../socketContext';import{st as myStyles}from'./styles';import Offer from'./Offer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var util=require(\"util\");function Messenger(props){var socket=useContext(SocketContext);var location=useLocation();var dispatch=useDispatch();var scrollRef=useRef();// const socket = useRef();\nvar _useSelector=useSelector(function(state){return state.messenger;}),contacts=_useSelector.contacts,message=_useSelector.message,messageSendSuccess=_useSelector.messageSendSuccess,messageGetSuccess=_useSelector.messageGetSuccess,new_user_add=_useSelector.new_user_add;var expert=location.state?location.state.expert:contacts&&contacts.length>0?contacts[0].contactInfo:\"\";var _useSelector2=useSelector(function(state){return state.auth;}),loading=_useSelector2.loading,authenticated=_useSelector2.authenticated,error=_useSelector2.error,successMessage=_useSelector2.successMessage,user=_useSelector2.user;var _useSelector3=useSelector(function(state){return state.offer;}),offer=_useSelector3.offer,offerContacts=_useSelector3.offerContacts,offerSendSuccess=_useSelector3.offerSendSuccess,offerGetSuccess=_useSelector3.offerGetSuccess;var myInfo=user;var _useState=useState(expert),_useState2=_slicedToArray(_useState,2),currentContact=_useState2[0],setCurrentContact=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),socketMessage=_useState4[0],setSocketMessage=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),socketOffer=_useState6[0],setSocketOffer=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),activeUser=_useState8[0],setActiveUser=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),hide=_useState10[0],setHide=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),typingMessage=_useState12[0],setTypingMessage=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),newMessage=_useState14[0],setNewMessage=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),price=_useState16[0],setPrice=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),offerFromMe=_useState18[0],setOfferFromMe=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),newOffer=_useState20[0],setNewOffer=_useState20[1];// gibt es ein offer ? // Das alles in Redux\nvar _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),askerId=_useState22[0],setAskerId=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),answererId=_useState24[0],setAnswererId=_useState24[1];useEffect(function(){myInfo=user;},[user]);useEffect(function(){socket.on('getMessage',function(data){setSocketMessage(data);});socket.on('getOffer',function(data){setSocketOffer(data);});socket.on('typingMessageGet',function(data){setTypingMessage(data);});socket.on('msgSeenResponse',function(msg){dispatch({type:'SEEN_MESSAGE',payload:{messageInfo:msg}});});socket.on('msgDeliveredResponse',function(msg){dispatch({type:'DELIVERED_MESSAGE',payload:{messageInfo:msg}});});socket.on('seenSuccess',function(data){dispatch({type:'SEEN_ALL',payload:data});});return function(){var _socket$current;(_socket$current=socket.current)===null||_socket$current===void 0?void 0:_socket$current.disconnect();};},[]);useEffect(function(){var myId=myInfo.id?myInfo.id:myInfo._id;dispatch(getContacts(myId));},[]);useEffect(function(){if(socketMessage&&currentContact!==\"\"){var myId=myInfo.id?myInfo.id:myInfo._id;if(socketMessage.senderId===currentContact._id&&socketMessage.receiverId===myId){dispatch({type:'SOCKET_MESSAGE',payload:{message:socketMessage}});dispatch(seenMessage(socketMessage));socket.emit('messageSeen',socketMessage);dispatch({type:'UPDATE_CONTACT_MESSAGE',payload:{messageInfo:socketMessage,status:'seen'}});}}setSocketMessage('');},[socketMessage]);useEffect(function(){if(socketOffer&&currentContact!==\"\"){var myId=myInfo.id?myInfo.id:myInfo._id;if(socketOffer.senderId===currentContact._id&&socketOffer.receiverId===myId){dispatch({type:'SOCKET_OFFER',payload:{offer:socketOffer}});}}setSocketOffer('');},[socketOffer]);useEffect(function(){var myId=myInfo.id?myInfo.id:myInfo._id;socket.emit('addUser',myId,myInfo);},[]);useEffect(function(){socket.on('getUser',function(users){var myId=myInfo.id?myInfo.id:myInfo._id;var activeUser=users.filter(function(u){return u.userId!==myId;});setActiveUser(activeUser);});socket.on('new_user_add',function(data){dispatch({type:'NEW_USER_ADD',payload:{new_user_add:data}});});},[]);useEffect(function(){var myId=myInfo.id?myInfo.id:myInfo._id;if(socketMessage&&socketMessage.senderId!==currentContact._id&&socketMessage.receiverId===myId){//  notificationSPlay();\ntoast.success(\"\".concat(socketMessage.senderName,\" Send a New Message\"));dispatch(updateMessage(socketMessage));socket.emit('deliveredMessage',socketMessage);dispatch({type:'UPDATE_CONTACT_MESSAGE',payload:{messageInfo:socketMessage,status:'delivered'}});}},[socketMessage]);useEffect(function(){var myId=myInfo.id?myInfo.id:myInfo._id;if(socketOffer&&socketOffer.senderId!==currentContact._id&&socketOffer.receiverId===myId){toast.success(\"\".concat(socketOffer.senderName,\" Send a New Offer\"));dispatch(updateOffer(socketOffer));socket.emit('deliveredOffer',socketOffer);}},[socketOffer]);var handleInput=function handleInput(newMessage){// TODO need main in here then\nvar myId=myInfo.id?myInfo.id:myInfo._id;setNewMessage(newMessage);socket.emit('typingMessage',{senderId:myId,receiverId:currentContact._id,msg:newMessage});};useEffect(function(){if(offerSendSuccess){var sendId;user.id?sendId=user.id:sendId=user._id;socket.emit('sendOffer',{senderName:user.username,receiverId:currentContact._id,offer:{price:price},askerId:askerId,senderId:sendId,answererId:answererId,status:\"false\"});dispatch({type:'OFFER_SEND_SUCCESS_CLEAR'});}},[offerSendSuccess]);var sendOffer=function sendOffer(type){var askId;var answId;var myId;user.id?myId=user.id:myId=user._id;if(type==='asker'){setAskerId(myId);askId=myId;answId=currentContact._id;setAnswererId(currentContact._id);}else{askId=currentContact._id;setAskerId(currentContact._id);answId=myId;setAnswererId(myId);}var data={senderName:user.username,senderId:myId,receiverId:currentContact._id,offer:{price:price},askerId:askId,answererId:answId,status:\"false\"};dispatch(offerSend(data));socket.emit('sendOffer',{senderName:user.username,senderId:myId,receiverId:currentContact._id,offer:{price:price},askerId:askId,answererId:answId,status:\"false\"});setNewOffer(true);setOfferFromMe(true);};var sendMessage=function sendMessage(msg){var myId=myInfo.id?myInfo.id:myInfo._id;var data={senderName:myInfo.username,receiverId:currentContact._id,message:newMessage?newMessage:'❤',senderId:myId};setTypingMessage('');socket.emit('typingMessage',{senderId:myId,receiver:currentContact._id,receiverId:currentContact._id,msg:''});dispatch(messageSend(data));setNewMessage('');};useEffect(function(){if(messageSendSuccess){// from redux state\nsocket.emit('sendMessage',message[message.length-1]);dispatch({type:'UPDATE_CONTACT_MESSAGE',payload:{messageInfo:message[message.length-1]}});dispatch({type:'MESSAGE_SEND_SUCCESS_CLEAR'});}},[messageSendSuccess]);useEffect(function(){// let data = myInfo.id\nconsole.log(myInfo);var myId=myInfo.id?myInfo.id:myInfo._id;dispatch(getContacts(myId));dispatch({type:'NEW_USER_ADD_CLEAR'});},[new_user_add]);useEffect(function(){var myId=myInfo.id?myInfo.id:myInfo._id;dispatch(getMessage(currentContact._id,myId));dispatch(getOffer(currentContact._id,myId));},[currentContact===null||currentContact===void 0?void 0:currentContact._id]);useEffect(function(){if(message.length>0){var myId=myInfo.id?myInfo.id:myInfo._id;if(message[message.length-1].senderId!==myId&&message[message.length-1].status!=='seen'){dispatch({type:'UPDATE',payload:{id:currentContact._id}});socket.emit('seen',{senderId:currentContact._id,receiverId:myId});dispatch(seenMessage({_id:message[message.length-1]._id}));}}dispatch({type:'MESSAGE_GET_SUCCESS_CLEAR'});},[messageGetSuccess]);useEffect(function(){var _scrollRef$current;(_scrollRef$current=scrollRef.current)===null||_scrollRef$current===void 0?void 0:_scrollRef$current.scrollIntoView({behavior:'smooth'});},[message]);var updatePrice=function updatePrice(updateDirection){var newPrice;var oldPrice=price;if(updateDirection===\"up\"){newPrice=++oldPrice;setPrice(newPrice);}if(updateDirection===\"down\"){newPrice=--oldPrice;setPrice(newPrice);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Toaster// notification\n,{position:'top-right',reverseOrder:false,toastOptions:{style:{display:'absolute',fontSize:'18px'}}}),/*#__PURE__*/_jsxs(\"div\",{style:myStyles.container,children:[/*#__PURE__*/_jsx(Offer,{currentContact:currentContact}),/*#__PURE__*/_jsx(\"div\",{style:myStyles.main,children:/*#__PURE__*/_jsxs(MainContainer,{responsive:true,style:{width:'100%'},children:[/*#__PURE__*/_jsx(Sidebar,{position:\"left\",scrollable:true,children:/*#__PURE__*/_jsx(ConversationList,{children:contacts&&contacts.length>0?contacts.map(function(contact,index){return contact.messageInfo?/*#__PURE__*/_jsx(Conversation,{onClick:function onClick(){setCurrentContact(contact.contactInfo);},active:currentContact._id===contact.contactInfo._id?true:false// activeUser={activeUser} \n,name:contact.contactInfo.username,info:contact.messageInfo?contact.messageInfo.message.text:\"no messages yet\"},index):null;}):/*#__PURE__*/_jsx(Conversation,{name:\"No Contacts\",info:\"No Messages\"})})}),/*#__PURE__*/_jsxs(ChatContainer,{children:[/*#__PURE__*/_jsxs(ConversationHeader,{children:[/*#__PURE__*/_jsx(ConversationHeader.Back,{}),/*#__PURE__*/_jsx(ConversationHeader.Content,{userName:currentContact.username// info=\"Active 10 mins ago\" \n}),/*#__PURE__*/_jsxs(ConversationHeader.Actions,{children:[/*#__PURE__*/_jsx(VoiceCallButton,{}),/*#__PURE__*/_jsx(VideoCallButton,{}),/*#__PURE__*/_jsx(InfoButton,{})]})]}),/*#__PURE__*/_jsx(MessageList,{typingIndicator:typingMessage.msg?/*#__PURE__*/_jsx(TypingIndicator,{content:currentContact.username+\" is typing\"}):false,children:message&&message.length>0?message.map(function(msg,index){return msg.senderId===myInfo.id||msg.senderId===myInfo._id?/*#__PURE__*/_jsx(Message,{model:{message:msg.message.text,sentTime:\"15 mins ago\",sender:msg.senderName,direction:\"outgoing\",position:\"normal\"},avatarSpacer:true},index):/*#__PURE__*/_jsx(Message,{model:{message:msg.message.text,sentTime:\"15 mins ago\",sender:msg.senderName,direction:\"incoming\",position:\"single\"},avatarSpacer:true},index);}):null}),/*#__PURE__*/_jsx(MessageInput,{placeholder:\"Type message here\",onSend:function onSend(e){return sendMessage(e);},onChange:function onChange(e){return handleInput(e);}})]}),/*#__PURE__*/_jsx(Sidebar,{position:\"right\",style:styles.sidebar,children:/*#__PURE__*/_jsx(ExpansionPanel,{open:true,title:\"Create new offer\",children:/*#__PURE__*/_jsxs(\"div\",{style:styles.offerContainer,children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.offerButtons,children:[/*#__PURE__*/_jsx(Button,{style:styles.button,onClick:function onClick(){return updatePrice(\"down\");},children:\"-\"}),/*#__PURE__*/_jsx(\"div\",{style:styles.price,children:price}),/*#__PURE__*/_jsx(Button,{style:styles.button,onClick:function onClick(){return updatePrice(\"up\");},children:\"+\"})]}),/*#__PURE__*/_jsx(Button,{style:styles.button,onClick:function onClick(e){return sendOffer(\"asker\");},children:\"Send Offer (I need help!) \"}),/*#__PURE__*/_jsx(Button,{style:styles.button,onClick:function onClick(e){return sendOffer(\"answerer\");},children:\"Send Offer (I'll help!)\"})]})})})]})})]})]});}export default Messenger;","map":{"version":3,"names":["React","useEffect","useState","useRef","useContext","useLocation","Button","styles","MainContainer","ChatContainer","MessageList","Message","MessageInput","Sidebar","Search","ConversationList","Conversation","ExpansionPanel","ConversationHeader","VoiceCallButton","VideoCallButton","InfoButton","TypingIndicator","MessageSeparator","useDispatch","useSelector","toast","Toaster","getContacts","messageSend","getMessage","ImageMessageSend","seenMessage","updateMessage","getOfferContacts","getOffer","offerSend","updateOffer","userGet","SocketContext","st","myStyles","Offer","util","require","Messenger","props","socket","location","dispatch","scrollRef","state","messenger","contacts","message","messageSendSuccess","messageGetSuccess","new_user_add","expert","length","contactInfo","auth","loading","authenticated","error","successMessage","user","offer","offerContacts","offerSendSuccess","offerGetSuccess","myInfo","currentContact","setCurrentContact","socketMessage","setSocketMessage","socketOffer","setSocketOffer","activeUser","setActiveUser","hide","setHide","typingMessage","setTypingMessage","newMessage","setNewMessage","price","setPrice","offerFromMe","setOfferFromMe","newOffer","setNewOffer","askerId","setAskerId","answererId","setAnswererId","on","data","msg","type","payload","messageInfo","current","disconnect","myId","id","_id","senderId","receiverId","emit","status","users","filter","u","userId","success","senderName","handleInput","sendId","username","sendOffer","askId","answId","sendMessage","receiver","console","log","scrollIntoView","behavior","updatePrice","updateDirection","newPrice","oldPrice","style","display","fontSize","container","main","width","map","contact","index","text","sentTime","sender","direction","position","e","sidebar","offerContainer","offerButtons","button"],"sources":["C:/Users/LeahC/OneDrive/Documents/AKAD/ABSCHLUSS BAK PROJ BACH/PROJEKT/ProjectCode/keep-going-react-app/frontend/src/Components/messenger/Messenger.jsx"],"sourcesContent":["\r\nimport React, { useEffect, useState, useRef, useContext } from 'react'\r\nimport { useLocation } from 'react-router-dom';\r\nimport { Button } from '@mui/material';\r\n\r\nimport styles from '@chatscope/chat-ui-kit-styles/dist/default/styles.min.css';\r\nimport { MainContainer, ChatContainer, MessageList, Message, MessageInput, Sidebar, Search, ConversationList, Conversation, ExpansionPanel, ConversationHeader, VoiceCallButton, VideoCallButton, InfoButton, TypingIndicator, MessageSeparator } from '@chatscope/chat-ui-kit-react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { getContacts, messageSend, getMessage, ImageMessageSend, seenMessage, updateMessage, } from '../../store/actions/messengerAction';\r\nimport { getOfferContacts, getOffer, offerSend, updateOffer } from '../../store/actions/offerAction';\r\nimport { userGet } from '../../store/actions/authActions';\r\n\r\nimport { SocketContext } from '../../socketContext';\r\n\r\nimport { st as myStyles } from './styles'\r\nimport Offer from './Offer';\r\nconst util = require(\"util\")\r\n\r\n\r\nfunction Messenger(props) {\r\n    const socket = useContext(SocketContext)\r\n    const location = useLocation();\r\n\r\n    const dispatch = useDispatch();\r\n    const scrollRef = useRef();\r\n    // const socket = useRef();\r\n\r\n    const { contacts, message, messageSendSuccess, messageGetSuccess, new_user_add } = useSelector(state => state.messenger);\r\n    let expert = location.state ? location.state.expert : contacts && contacts.length > 0 ? contacts[0].contactInfo : \"\";\r\n    const { loading, authenticated, error, successMessage, user } = useSelector(state => state.auth);\r\n    const { offer, offerContacts, offerSendSuccess, offerGetSuccess } = useSelector(state => state.offer);\r\n    let myInfo = user\r\n\r\n\r\n    const [currentContact, setCurrentContact] = useState(expert);\r\n    const [socketMessage, setSocketMessage] = useState(\"\");\r\n    const [socketOffer, setSocketOffer] = useState(\"\");\r\n    const [activeUser, setActiveUser] = useState(\"\");\r\n    const [hide, setHide] = useState(true);\r\n\r\n    const [typingMessage, setTypingMessage] = useState('');\r\n\r\n    const [newMessage, setNewMessage] = useState('');\r\n\r\n    const [price, setPrice] = useState(0);\r\n    const [offerFromMe, setOfferFromMe] = useState(false);\r\n    const [newOffer, setNewOffer] = useState(false) // gibt es ein offer ? // Das alles in Redux\r\n\r\n    const [askerId, setAskerId] = useState(\"\")\r\n    const [answererId, setAnswererId] = useState(\"\")\r\n\r\n    useEffect(() => {\r\n        myInfo = user\r\n    }, [user])\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        socket.on('getMessage', (data) => {\r\n            setSocketMessage(data)\r\n        })\r\n\r\n        socket.on('getOffer', (data) => {\r\n            setSocketOffer(data)\r\n        })\r\n\r\n        socket.on('typingMessageGet', (data) => {\r\n            setTypingMessage(data)\r\n        })\r\n\r\n        socket.on('msgSeenResponse', msg => {\r\n            dispatch({\r\n                type: 'SEEN_MESSAGE',\r\n                payload: {\r\n                    messageInfo: msg\r\n                }\r\n            })\r\n        })\r\n\r\n        socket.on('msgDeliveredResponse', msg => {\r\n            dispatch({\r\n                type: 'DELIVERED_MESSAGE',\r\n                payload: {\r\n                    messageInfo: msg\r\n                }\r\n            })\r\n        })\r\n\r\n        socket.on('seenSuccess', data => {\r\n            dispatch({\r\n                type: 'SEEN_ALL',\r\n                payload: data\r\n            })\r\n        })\r\n\r\n        return () => { socket.current?.disconnect() }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        dispatch(getContacts(myId))\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (socketMessage && currentContact !== \"\") {\r\n            let myId = myInfo.id ? myInfo.id : myInfo._id\r\n            if (socketMessage.senderId === currentContact._id && socketMessage.receiverId === myId) {\r\n                dispatch({\r\n                    type: 'SOCKET_MESSAGE',\r\n                    payload: {\r\n                        message: socketMessage\r\n                    }\r\n                })\r\n                dispatch(seenMessage(socketMessage));\r\n                socket.emit('messageSeen', socketMessage);\r\n                dispatch({\r\n                    type: 'UPDATE_CONTACT_MESSAGE',\r\n                    payload: {\r\n                        messageInfo: socketMessage,\r\n                        status: 'seen'\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        setSocketMessage('')\r\n    }, [socketMessage]);\r\n\r\n\r\n    useEffect(() => {\r\n        if (socketOffer && currentContact !== \"\") {\r\n            let myId = myInfo.id ? myInfo.id : myInfo._id\r\n            if (socketOffer.senderId === currentContact._id && socketOffer.receiverId === myId) {\r\n                dispatch({\r\n                    type: 'SOCKET_OFFER',\r\n                    payload: {\r\n                        offer: socketOffer\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        setSocketOffer('')\r\n    }, [socketOffer]);\r\n\r\n\r\n    useEffect(() => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        socket.emit('addUser', myId, myInfo)\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        socket.on('getUser', (users) => {\r\n            let myId = myInfo.id ? myInfo.id : myInfo._id\r\n            const activeUser = users.filter(u => u.userId !== myId)\r\n            setActiveUser(activeUser)\r\n        })\r\n\r\n        socket.on('new_user_add', data => {\r\n            dispatch({\r\n                type: 'NEW_USER_ADD',\r\n                payload: {\r\n                    new_user_add: data\r\n                }\r\n            })\r\n        })\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        if (socketMessage && socketMessage.senderId !== currentContact._id && socketMessage.receiverId === myId) {\r\n            //  notificationSPlay();\r\n            toast.success(`${socketMessage.senderName} Send a New Message`)\r\n            dispatch(updateMessage(socketMessage));\r\n            socket.emit('deliveredMessage', socketMessage);\r\n            dispatch({\r\n                type: 'UPDATE_CONTACT_MESSAGE',\r\n                payload: {\r\n                    messageInfo: socketMessage,\r\n                    status: 'delivered'\r\n                }\r\n            })\r\n\r\n        }\r\n    }, [socketMessage]);\r\n\r\n    useEffect(() => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        if (socketOffer && socketOffer.senderId !== currentContact._id && socketOffer.receiverId === myId) {\r\n            toast.success(`${socketOffer.senderName} Send a New Offer`)\r\n            dispatch(updateOffer(socketOffer));\r\n            socket.emit('deliveredOffer', socketOffer);\r\n\r\n        }\r\n    }, [socketOffer]);\r\n\r\n\r\n    const handleInput = (newMessage) => { // TODO need main in here then\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        setNewMessage(newMessage)\r\n        socket.emit('typingMessage', {\r\n            senderId: myId,\r\n            receiverId: currentContact._id,\r\n            msg: newMessage\r\n        })\r\n\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (offerSendSuccess) {\r\n\r\n            let sendId\r\n            user.id ? sendId = user.id : sendId = user._id\r\n            socket.emit('sendOffer', {\r\n                senderName: user.username,\r\n                receiverId: currentContact._id,\r\n                offer: { price: price },\r\n                askerId: askerId,\r\n                senderId: sendId,\r\n                answererId: answererId,\r\n                status: \"false\"\r\n            })\r\n            dispatch({\r\n                type: 'OFFER_SEND_SUCCESS_CLEAR'\r\n            })\r\n        }\r\n    }, [offerSendSuccess])\r\n\r\n    const sendOffer = (type) => {\r\n\r\n        let askId\r\n        let answId\r\n        let myId\r\n        user.id ? myId = user.id : myId = user._id\r\n\r\n        if (type === 'asker') {\r\n            setAskerId(myId)\r\n            askId = myId\r\n            answId = currentContact._id\r\n            setAnswererId(currentContact._id)\r\n\r\n        } else {\r\n            askId = currentContact._id\r\n            setAskerId(currentContact._id)\r\n            answId = myId\r\n            setAnswererId(myId)\r\n        }\r\n\r\n\r\n\r\n        const data = {\r\n            senderName: user.username,\r\n            senderId: myId,\r\n            receiverId: currentContact._id,\r\n            offer: { price: price },\r\n            askerId: askId,\r\n            answererId: answId,\r\n            status: \"false\"\r\n        }\r\n\r\n        dispatch(offerSend(data));\r\n\r\n\r\n        socket.emit('sendOffer', {\r\n            senderName: user.username,\r\n            senderId: myId,\r\n            receiverId: currentContact._id,\r\n            offer: { price: price },\r\n            askerId: askId,\r\n            answererId: answId,\r\n            status: \"false\"\r\n        })\r\n\r\n\r\n        setNewOffer(true)\r\n        setOfferFromMe(true)\r\n    }\r\n\r\n    const sendMessage = (msg) => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n\r\n        const data = {\r\n            senderName: myInfo.username,\r\n            receiverId: currentContact._id,\r\n            message: newMessage ? newMessage : '❤',\r\n            senderId: myId\r\n        }\r\n\r\n        setTypingMessage('')\r\n\r\n        socket.emit('typingMessage', {\r\n            senderId: myId,\r\n            receiver: currentContact._id,\r\n            receiverId: currentContact._id,\r\n            msg: ''\r\n        })\r\n\r\n        dispatch(messageSend(data));\r\n        setNewMessage('');\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (messageSendSuccess) { // from redux state\r\n            socket.emit('sendMessage', message[message.length - 1]);\r\n            dispatch({\r\n                type: 'UPDATE_CONTACT_MESSAGE',\r\n                payload: {\r\n                    messageInfo: message[message.length - 1]\r\n                }\r\n            })\r\n            dispatch({\r\n                type: 'MESSAGE_SEND_SUCCESS_CLEAR'\r\n            })\r\n        }\r\n    }, [messageSendSuccess]);\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        // let data = myInfo.id\r\n        console.log(myInfo)\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        dispatch(getContacts(myId))\r\n        dispatch({ type: 'NEW_USER_ADD_CLEAR' })\r\n    }, [new_user_add]);\r\n\r\n    useEffect(() => {\r\n        let myId = myInfo.id ? myInfo.id : myInfo._id\r\n        dispatch(getMessage(currentContact._id, myId));\r\n        dispatch(getOffer(currentContact._id, myId));\r\n    }, [currentContact?._id]);\r\n\r\n\r\n    useEffect(() => {\r\n        if (message.length > 0) {\r\n            let myId = myInfo.id ? myInfo.id : myInfo._id\r\n            if (message[message.length - 1].senderId !== myId && message[message.length - 1].status !== 'seen') {\r\n                dispatch({\r\n                    type: 'UPDATE',\r\n                    payload: {\r\n                        id: currentContact._id\r\n                    }\r\n                })\r\n                socket.emit('seen', { senderId: currentContact._id, receiverId: myId })\r\n                dispatch(seenMessage({ _id: message[message.length - 1]._id }))\r\n            }\r\n        }\r\n        dispatch({\r\n            type: 'MESSAGE_GET_SUCCESS_CLEAR'\r\n        })\r\n\r\n    }, [messageGetSuccess]);\r\n\r\n    useEffect(() => {\r\n        scrollRef.current?.scrollIntoView({ behavior: 'smooth' })\r\n    }, [message]);\r\n\r\n    const updatePrice = (updateDirection) => {\r\n        let newPrice\r\n        let oldPrice = price\r\n        if (updateDirection === \"up\") {\r\n\r\n            newPrice = ++oldPrice\r\n            setPrice(newPrice)\r\n        }\r\n        if (updateDirection === \"down\") {\r\n            newPrice = --oldPrice\r\n            setPrice(newPrice)\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    return (<div>\r\n        <Toaster // notification\r\n            position={'top-right'}\r\n            reverseOrder={false}\r\n            toastOptions={{\r\n                style: {\r\n                    display: 'absolute',\r\n                    fontSize: '18px'\r\n                }\r\n            }}\r\n\r\n        />\r\n        <div style={myStyles.container}>\r\n            <Offer currentContact={currentContact} />\r\n            <div style={myStyles.main}>\r\n\r\n                <MainContainer responsive style={{ width: '100%' }}>\r\n                    <Sidebar position=\"left\" scrollable={true}>\r\n                        {/* <Search placeholder=\"Search...\" /> */}\r\n                        <ConversationList>\r\n\r\n                            {contacts && contacts.length > 0 ? contacts.map((contact, index) =>\r\n                                contact.messageInfo ?\r\n                                    <Conversation\r\n                                        key={index}\r\n                                        onClick={() => { setCurrentContact(contact.contactInfo) }}\r\n                                        active={currentContact._id === contact.contactInfo._id ? true : false}\r\n                                        // activeUser={activeUser} \r\n                                        name={contact.contactInfo.username} info={contact.messageInfo ? contact.messageInfo.message.text : \"no messages yet\"}>\r\n\r\n                                    </Conversation> : null\r\n                            ) : <Conversation name={\"No Contacts\"} info=\"No Messages\">\r\n\r\n                            </Conversation>}\r\n\r\n                        </ConversationList>\r\n                    </Sidebar>\r\n\r\n                    <ChatContainer>\r\n                        <ConversationHeader>\r\n                            <ConversationHeader.Back />\r\n                            {/* <Avatar src={zoeIco} name=\"Zoe\" /> */}\r\n                            <ConversationHeader.Content userName={currentContact.username}\r\n                            // info=\"Active 10 mins ago\" \r\n                            />\r\n                            <ConversationHeader.Actions>\r\n                                <VoiceCallButton />\r\n                                <VideoCallButton />\r\n                                <InfoButton />\r\n                            </ConversationHeader.Actions>\r\n                        </ConversationHeader>\r\n                        <MessageList typingIndicator={typingMessage.msg ? <TypingIndicator content={currentContact.username + \" is typing\"} /> : false} >\r\n                            {/* \r\n                        {typingMessage.senderId === currentContact._id ? <TypingIndicator content=\" is typing\" /> : null} */}\r\n\r\n\r\n                            {/* <MessageSeparator content=\"Saturday, 30 November 2019\" /> */}\r\n                            {message && message.length > 0 ?\r\n\r\n                                message.map((msg, index) =>\r\n                                (msg.senderId === myInfo.id || msg.senderId === myInfo._id ?\r\n                                    < Message key={index}\r\n                                        model={{\r\n                                            message: msg.message.text,\r\n                                            sentTime: \"15 mins ago\",\r\n                                            sender: msg.senderName,\r\n                                            direction: \"outgoing\",\r\n                                            position: \"normal\"\r\n                                        }} avatarSpacer /> :\r\n                                    <Message key={index}\r\n                                        model={{\r\n                                            message: msg.message.text,\r\n                                            sentTime: \"15 mins ago\",\r\n                                            sender: msg.senderName,\r\n                                            direction: \"incoming\",\r\n                                            position: \"single\"\r\n                                        }} avatarSpacer />\r\n                                ))\r\n\r\n                                : null}\r\n\r\n                        </MessageList>\r\n                        <MessageInput placeholder=\"Type message here\"\r\n                            onSend={(e) => sendMessage(e)}\r\n                            onChange={(e) => handleInput(e)}\r\n                        />\r\n                    </ChatContainer>\r\n\r\n                    <Sidebar position=\"right\" style={styles.sidebar}>\r\n                        <ExpansionPanel open title=\"Create new offer\">\r\n                            <div style={styles.offerContainer}>\r\n                                <div style={styles.offerButtons}>\r\n                                    <Button style={styles.button} onClick={() => updatePrice(\"down\")}>-</Button>\r\n                                    <div style={styles.price}>{price}</div>\r\n                                    <Button style={styles.button} onClick={() => updatePrice(\"up\")}>+</Button>\r\n\r\n                                </div>\r\n                                <Button style={styles.button} onClick={(e) => sendOffer(\"asker\")}>Send Offer (I need help!) </Button>\r\n                                <Button style={styles.button} onClick={(e) => sendOffer(\"answerer\")}>Send Offer (I'll help!)</Button>\r\n                            </div>\r\n                        </ExpansionPanel>\r\n                        {/* <ExpansionPanel open title=\"Older Offers\">\r\n                        \r\n\r\n                            {offerContacts && offerContacts.length > 0 ? offerContacts.map((contact, index) => {\r\n                                <div>\r\n                                    <div>\r\n\r\n                                         asker : {contact.offerInfo.askerId} \r\n                    </div>\r\n                    <div>\r\n                        price : {contact.offerInfo.offer.price}\r\n\r\n                    </div>\r\n                    <div>\r\n\r\n                    </div>\r\n                    <div>\r\n                        status : {contact.offerInfo.status}\r\n                    </div>\r\n            </div>\r\n                            }) : null}\r\n\r\n        </ExpansionPanel> */}\r\n                    </Sidebar>\r\n                </MainContainer >\r\n            </div >\r\n        </div ></div >\r\n    )\r\n}\r\nexport default Messenger;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}